dataset_path: /scr2/muj_random_20200728/
  #/scr2/muj_motion_primitive_20200722/

dataloading_params:
  num_workers: 4
  batch_size: 128
  idx_dict_path: 
    #/scr-ssd/sens_search_logging/models/20200801_training_2_rl_policy/val_train_split.pkl

training_params:
  seed: 4321
  regularization_weight: 0.00001
  lrn_rate: 0.0001
  beta1: 0.9
  beta2: 0.99
  max_training_epochs: 5000
  val_ratio: 0.1
  dev_num: 20 # number of datapoints in the development set
  use_GPU: True
  run_mode: 1 # 0 - development, 1 - training, 2 - testing

logging_params:
  logging_folder: "/scr-ssd/sens_search_logging/" # Place your logging folder in a seperate location then your local code repository
  run_notes: "_rl_policy"

custom_params:
  image_size: [3, 128, 128]
  force_size: [6, 50]
  action_size: 3
  macro_action_size: 4
  proprio_size: 12
  min_length: 20
  max_length: 100
  dropout_prob: 0.2
  
dataset_keys: ["force_hi_freq", "action", "rel_proprio", "contact", "peg_vector", "hole_vector", "fit_vector", "hole_sites"] #, 'image', 'depth']

info_flow:
  History_Encoder_Transformer:
    train: 1
    model_folder: "" #/scr-ssd/sens_search_logging/models/20200801_training_2_rl_policy/ #"/scr-ssd/sens_search_logging/models/20200627_training_25_rl_policy/" #"/scr-ssd/sens_search_logging/models/20200602_training_7_fit_wexpanded_action/" #"/scr-ssd/sens_search_logging/models/20200601_training_44_fit_wexpanded_action/" #"/scr-ssd/sens_search_logging/models/20200601_training_7_fit_wexpanded_action/" #"/scr-ssd/sens_search_logging/models/20200531_training_27_fit_wexpanded_action/" #"/scr-ssd/sens_search_logging/models/20200531_training_21_fit_wexpanded_action/"  #"/scr-ssd/sens_search_logging/models/20200530_training_12_fit_wexpanded_action/" #"/scr-ssd/sens_search_logging/models/20200529_training_45_fit_wexpanded_action/" #"/scr-ssd/sens_search_logging/models/20200529_training_20_fit_wexpanded_action/"
    epoch: 0 #5000
    init_args:
      num_tools: 3
      num_states: 3
      num_options: 2
      action_size: 3
      proprio_size: 12
      force_size: [6, 50]
      dropout_prob: 0.2
      min_length: 20
    inputs:
      rel_proprio: dataset
      action: dataset
      force_hi_freq: dataset
      contact: dataset
      tool_idx: dataset
      padding_mask: dataset
      epoch: dataset
    outputs:
      pos_est:
        inputs:
          rel_pos_final: dataset
        losses:
          L1:
            weight: 500
            logging_name: Position_Estimate
        evals:
          Continuous_Error:
            logging_name:  Pos_Err_Force
      state_logits:
        inputs:
          state_idx: dataset
        losses: 
          Multinomial_NLL:
            logging_name: Hole_Shape_Class
      state_inputs:
        inputs:
          state_idx: dataset
        evals:
          Multinomial_Accuracy:
            logging_name: "classifier_accuracy"
